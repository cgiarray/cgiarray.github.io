---
import HamburgerToggle from '../components/hamburgerToggle.astro';
import SearchToggle from '../components/SearchToggle.astro';
const currentPath = Astro.url.pathname;
const isWebAnimationsPage = currentPath.startsWith('/web-animations');
const isTemplatesPage = currentPath.startsWith('/templates');
const is3DAssetsPage = currentPath.startsWith('/3d-assets');
---

<div class="header-wrapper">
  <!-- Row 1: Logo + Search Toggle on Left + Hamburger on Right -->
  <div class="logo-row">
    <div class="left-group">
      <a href="/" aria-label="Home" class="logo-link">
        <img src="/images/web-logo.png" alt="CGIArray Logo" class="logo" />
      </a>

      <button id="search-toggle-button" class="search-toggle-button" aria-label="Toggle search">
        <i class="fas fa-search"></i>
      </button>
    </div>

    <button id="hamburger-toggle" class="hamburger-button" aria-label="Toggle menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>

  <!-- Search Bar -->
  <div class="search-bar" id="search-bar" role="search" aria-label="Site search">
    <select class="search-category" aria-label="Search category">
      <option value="all">All</option>
      <option value="templates">Templates</option>
      <option value="3d-assets">3D Assets</option>
      <option value="plugins">Plugins</option>
      <option value="animations">Animations</option>
    </select>
    <input
      id="search-input"
      type="search"
      placeholder="Search..."
      class="search-input-bar"
      aria-label="Search site content"
    />
    <button id="search-submit-button" class="search-button" aria-label="Submit search">
      <i class="fas fa-search"></i>
    </button>
  </div>

  <!-- Navigation Menu -->
  <nav role="navigation" aria-label="Main navigation" id="main-nav">
    <ul class="nav-links">
      <li><a href="/"><i class="fas fa-house"></i></a></li>

      <li class="dropdown">
        <div class="mobile-link-wrapper">
          <a href="/web-animations" class={`nav-link ${isWebAnimationsPage ? 'active' : ''}`} aria-haspopup="true" aria-expanded="false">
            Web Animations
          </a>
          <button class="dropdown-toggle" aria-expanded="false" aria-label="Toggle submenu">˅</button>
        </div>
        <ul class="dropdown-menu">
          <li><a href="#"><i class="fas fa-rocket"></i> Hero Animations</a></li>
          <li><a href="#"><i class="fas fa-angle-double-down"></i> Footer Animations</a></li>
          <li><a href="#"><i class="fas fa-vector-square"></i> Vector Animations (SVG + Lottie)</a></li>
        </ul>
      </li>

      <li class="dropdown">
        <div class="mobile-link-wrapper">
          <a href="/3d-assets" class={`nav-link ${is3DAssetsPage ? 'active' : ''}`} aria-haspopup="true" aria-expanded="false">
            3D Assets
          </a>
          <button class="dropdown-toggle" aria-expanded="false" aria-label="Toggle submenu">˅</button>
        </div>
        <ul class="dropdown-menu">
          <li><a href="/3d-assets/rigged-characters">Rigged Characters</a></li>
          <li><a href="/3d-assets/modular-kits">Modular Kits</a></li>
          <li><a href="/3d-assets/v-tuber-avatars">V-Tuber Avatars</a></li>
        </ul>
      </li>

      <li class="dropdown">
        <div class="mobile-link-wrapper">
          <a href="/templates" class={`nav-link ${isTemplatesPage ? 'active' : ''}`} aria-haspopup="true" aria-expanded="false">
            Templates
          </a>
          <button class="dropdown-toggle" aria-expanded="false" aria-label="Toggle submenu">˅</button>
        </div>
        <ul class="dropdown-menu">
          <li><a href="#"><span class="app-icon ae-icon">Ae</span> Adobe After Effects</a></li>
          <li><a href="#"><span class="app-icon pr-icon">Pr</span> Adobe Premiere Pro</a></li>
          <li><a href="#"><span class="app-icon c4d-icon">M</span> Maxon Cinema 4D</a></li>
        </ul>
      </li>

      <li><a href="/plugins">Plugins</a></li>
      <li><a href="/tutorials">Tutorials</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/contact">Contact</a></li>
      <li><a href="/licensing">Licensing</a></li>
    </ul>
  </nav>

  <!-- Scripts -->
  <HamburgerToggle />
  <SearchToggle />
</div>
